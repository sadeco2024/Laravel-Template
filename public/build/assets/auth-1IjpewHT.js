window.saveLink=function(e){console.log(e);const o=e.getAttribute("data-link");e.data={btnhtml:e.innerHTML},e.innerHTML='<span class="spinner-border spinner-border-sm ms-1" role="status" aria-hidden="true"></span>',e.disabled=!0,fetch(o).then(t=>t.json()).then(t=>{if(console.log(t,t.status),t.form&&typeof t.form=="object")for(let r in t.form){let s=t.form[r];document.getElementsByName(r)[0].value=s}if(t.table&&typeof t.table=="object")for(let r in t.table){let c=document.getElementById(r).getElementsByTagName("tbody")[0];c.innerHTML="",Array.isArray(t.table[r])&&t.table[r].forEach(d=>{let f=c.insertRow();for(let l in d){let i=f.insertCell();i.innerHTML=d[l]}})}try{Swal.fire({position:"center",icon:t.status>0?"error":"success",title:t.msg??(t.status?"Operación NO realizada.":"Operación realizada con éxito."),showConfirmButton:!1,timer:1500})}catch{throw new Error("Error: Falta librería SweetAlerts2")}e.innerHTML=e.data.btnhtml,e.disabled=!1}).catch(t=>{console.error("Error:",t)})};document.querySelectorAll(".sd-modalForm").forEach(e=>{const o=document.querySelector(".modal-body"),t=document.querySelector(".modal-title");e.addEventListener("show.bs.modal",function(r){const s=r.relatedTarget,c=s.getAttribute("data-url"),d=s.getAttribute("data-title"),f=s.getAttribute("data-param");t.textContent=d,o.innerHTML="",fetch(c).then(l=>l.text()).then(l=>{o.innerHTML=l;const i=o.querySelector("form"),u=document.createElement("input");u.type="hidden",u.name="param",u.value=f,i.appendChild(u),i.addEventListener("submit",function(w){w.preventDefault();const n=document.querySelector(".modal-footer").querySelector('[type="submit"]');n.data={btnhtml:n.innerHTML},n.innerHTML='<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Guardando...',n.disabled=!0,fetch(i.action,{method:i.method,body:new FormData(i)}).then(a=>a.json()).then(a=>{if(v(),a.redirect)if(a.alert){try{Swal.fire({position:"center",icon:"success",title:a.alert,showConfirmButton:!1,timer:1500})}catch{throw new Error("Error: Falta librería SweetAlerts2")}n.innerHTML=n.data.btnhtml,n.disabled=!1}else window.location.href=a.redirect;else if(n.innerHTML=n.data.btnhtml,n.disabled=!1,a.errors){const m=a.errors;for(const p in m){const E=m[p][0],h=document.createElement("small");h.classList.add("text-sm","text-danger","text-muted","invalid"),h.textContent=E;const y=document.getElementsByName(p)[0];y.classList.add("is-invalid"),y.closest(".input-group").insertAdjacentElement("afterend",h)}}}).catch(a=>{n.innerHTML=n.data.btnhtml,n.disabled=!1,console.error("Error:",a)})})})})});function v(){document.querySelectorAll("small.invalid").forEach(o=>{o.remove()}),document.querySelectorAll("form .is-invalid").forEach(o=>{o.classList.remove("is-invalid")})}document.querySelectorAll(".save").forEach(e=>{e.addEventListener("click",o=>{o.preventDefault(),e.data={btnhtml:e.innerHTML},e.innerHTML='<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Guardando...',e.disabled=!0;const t=e.closest("form");fetch(t.action,{method:t.method,body:new FormData(t)}).then(r=>r.json()).then(r=>{e.innerHTML=e.data.btnhtml,e.disabled=!1;try{console.log(r.status),Swal.fire({position:"center",icon:r.status>0?"error":"success",title:r.msg!==""?r.msg:r.status>0?"Operación NO realizada.":"Operación realizada con éxito.",showConfirmButton:!1,timer:1500})}catch(s){throw new Error("Mensaje: "+s.message)}}).catch(r=>{e.innerHTML=e.data.btnhtml,e.disabled=!1,console.error("Error:",r)})})});document.querySelectorAll(".save-link").forEach(e=>{e.addEventListener("click",o=>{o.preventDefault(),console.log(e);const t=e.getAttribute("data-link");e.data={btnhtml:e.innerHTML},e.innerHTML='<span class="spinner-border spinner-border-sm ms-1" role="status" aria-hidden="true"></span>',e.disabled=!0,fetch(t).then(r=>r.json()).then(r=>{try{Swal.fire({position:"center",icon:r.status>0?"error":"success",title:r.msg??(r.status?"Operación NO realizada.":"Operación realizada con éxito."),showConfirmButton:!1,timer:1500})}catch{throw new Error("Error: Falta librería SweetAlerts2")}e.innerHTML=e.data.btnhtml,e.disabled=!1}).catch(r=>{console.error("Error:",r)})})});var g;(g=document.getElementById("delete-confirm-form"))==null||g.forEach(e=>{e.addEventListener("click",o=>{o.preventDefault(),Form=o.target.closest("form"),Swal.fire({title:"¿Esta usted seguro?",text:"Esta acción no se puede deshacer",icon:"warning",showCancelButton:!0,cancelButtonText:"Cancelar",confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Eliminar rol"}).then(t=>{t.isConfirmed&&(Swal.fire("Eliminado!","El rol ha sido eliminado.","success"),Form.submit())})})});document.querySelectorAll(".daterange").forEach(e=>{try{flatpickr(e,{mode:"range",dateFormat:"d-m-Y",locale:"es"})}catch{throw"Error al cargar el datepicker"}});var b={series:[{name:"Kits",data:[44,55,41,42,22,43,21,35,56,27,43,27]},{name:"Chips",data:[33,21,32,37,23,32,47,31,54,32,20,38]},{name:"Portas",data:[30,25,36,30,45,35,64,51,59,36,39,51]},{name:"Otros",data:[2,0,0,1,1,2,0,0,3,4,1,5]}],chart:{type:"bar",height:360,fontFamily:"Poppins, sans-serif",foreColor:"#8c9097",stacked:!0,toolbar:{show:!1},zoom:{enabled:!0}},grid:{borderColor:"#90A4AE",strokeDashArray:2},dataLabels:{enabled:!1},responsive:[{breakpoint:480,options:{legend:{position:"bottom",offsetX:-10,offsetY:0}}}],stroke:{show:!0,width:[5,5,5,5],curve:"smooth"},plotOptions:{bar:{columnWidth:"10%",horizontal:!1}},legend:{position:"right",offsetY:40},fill:{opacity:1},legend:{show:!1},tooltip:{enabled:!0,shared:!0,intersect:!1},labels:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]};if(document.querySelector("#grafica-activaciones-mensuales")){var L=new ApexCharts(document.querySelector("#grafica-activaciones-mensuales"),b);L.render()}var b={series:[44,55,13,43],chart:{width:220,height:220,type:"pie"},colors:["var(--primary08)","rgba(69, 214, 91, 0.8)","rgba(243, 156, 18, 0.8)","rgba(231, 76, 60, 0.8)"],labels:["Mobile","Desktop","Laptop","Tablet"],legend:{show:!1},stroke:{width:0},dataLabels:{enabled:!0,dropShadow:{enabled:!1}}};if(document.querySelector("#leads-source")){var T=new ApexCharts(document.querySelector("#leads-source"),b);T.render()}if(document.getElementById("tblTelcelCanales")){const e=$("#tblTelcelCanales").DataTable({dom:"Brtip",buttons:["copy","excel","print"],pageLength:10,resposive:!0});Array.from(e.buttons().nodes()).forEach(t=>{t.classList.remove("btn-secondary"),t.classList.add("btn-sm","btn-outline-info","btn-wave","waves-effect","waves-light")}),$("thead",e.table).addClass("text-info"),$(".pagination",e.table).addClass("my-2"),e.buttons().container().appendTo("#btnTelcelCanales"),$("#src_telcel_canal").on("keyup",function(){e.search(this.value).draw()})}
